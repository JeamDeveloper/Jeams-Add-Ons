<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Página de Inicio - Lightning Cube</title>
    <link rel="stylesheet" href="styles.css">
    
    <!-- Icono de la página -->
    <link rel="icon" 
          href="https://github.com/JeamDeveloper/Lightning-Cube/blob/b825d46606c034cd388afe4c455f28235f2bb9e6/resources/images/icons/MMAPlus%20Icon.PNG?raw=true" 
          type="image/png">
    
    <!-- Descripción de la página -->
    <meta name="description" content="Página de inicio de Lightning Cube">
</head>

<body>
    
<!-- Barra de herramientas (toolbar) en la parte superior -->
<div class="toolbar">
    <a href="https://lightningcube.netlify.app" class="toolbar-link">
        <img src="https://github.com/JeamDeveloper/Lightning-Cube/blob/b825d46606c034cd388afe4c455f28235f2bb9e6/resources/images/icons/MMAPlus%20Icon.PNG?raw=true" 
             alt="LCLOGO" class="toolbar-logo">
        <span class="toolbar-text">LIGHTNING CUBE</span>
    </a>
</div>

<div class="home-bg-page">
    <!-- Contenedor con fondo oscuro y contenido dentro -->
    <div class="darker-page-content">
        <div class="container">
            <!-- Título del addon -->
            <div class="page-title">Pagina Principal</div>

            <!-- Texto descriptivo del addon -->
            <div class="default-texto">¡Descubre nuestros Add-Ons y Paquetes de texturas!</div>
        </div>
    </div>
</div>

<!-- Contenedor de lista de submissions -->
<div id="submissions-container">
    <h2>Submissions</h2>
    <div id="submissions-list"></div>
</div>

<div class="social-container">
    <p class="social-title">Síguenos en nuestras redes sociales</p>
    <div class="social-links">
        <a href="https://mcpedl.com/user/jeamdude/" class="social-link">MCPEDL</a>
        <a href="https://www.instagram.com/jeamstudiosofi/" class="social-link">Instagram</a>
    </div>
</div>

<!-- Contenedor de los créditos (Fuera de mm-addon-page) -->
<div class="credits">
    <div class="credits-text">
        <p>Lightning Cubes © 2024 JeamDude</p>
        <p>Licensed under CC BY-NC-ND 4.0</p>
    </div>
</div>

<!-- Cargar script -->
<script src="homescript.js"></script>
<script>
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            navigator.serviceWorker.register('sw.js').then(registration => {
                console.log('Service Worker registrado con éxito:', registration);
            }).catch(error => {
                console.log('Error al registrar el Service Worker:', error);
            });
        });
    }
</script>
<script type="module">
    // Importa Firebase
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-analytics.js";
    import { getDatabase, ref, get, child } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

    // Configuración de Firebase
    const firebaseConfig = {
        apiKey: "AIzaSyAPKImW3I6rYMZ95bY97KUo3qDLAFJF16Y",
        authDomain: "lightning-cube-3edce.firebaseapp.com",
        projectId: "lightning-cube-3edce",
        storageBucket: "lightning-cube-3edce.appspot.com",
        messagingSenderId: "833313409687",
        appId: "1:833313409687:web:bb34600cea6aeda0c177d2",
        measurementId: "G-9KTSWKDJ6F"
    };

    // Inicializa Firebase
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const db = getDatabase();

    // Función para obtener los datos de 'submissions'
    async function obtenerSubmissions() {
        const dbRef = ref(db, "submissions");
        const submissionsList = document.getElementById("submissions-list");
        submissionsList.innerHTML = ""; // Limpiar contenido previo

        try {
            const snapshot = await get(child(ref(db), "submissions"));
            if (snapshot.exists()) {
                snapshot.forEach((categorySnapshot) => {
                    const category = categorySnapshot.key;
                    const categoryContainer = document.createElement("div");
                    const categoryTitle = document.createElement("h3");
                    const categoryList = document.createElement("ul");

                    categoryTitle.textContent = category;
                    categoryContainer.appendChild(categoryTitle);
                    categoryContainer.appendChild(categoryList);

                    // Iterar sobre child keys de la categoría
                    categorySnapshot.forEach((postSnapshot) => {
                        const postName = postSnapshot.val().postname;
                        if (postName) {
                            const listItem = document.createElement("li");
                            listItem.textContent = postName;
                            categoryList.appendChild(listItem);
                        }
                    });

                    submissionsList.appendChild(categoryContainer);
                });
            } else {
                submissionsList.textContent = "No se encontraron datos.";
            }
        } catch (error) {
            console.error("Error al obtener datos:", error);
        }
    }

    // Llamada a la función
    document.addEventListener("DOMContentLoaded", obtenerSubmissions);
</script>
</body>

</html>